# =============================================================================================
# =============================================================================================
# Test the assembler / disassembler syntax and parsing process. The idea is to set the
# memory address 0 to zero, modify it with the value of the assembler result and then 
# display the memory cell as assembly code again. 
#
# =============================================================================================
# =============================================================================================
#
ENV ENV_ECHO_CMD_INPUT true
#
# =============================================================================================
# 
# Test OpMode argument cases for success and failure
#
# =============================================================================================
w disasm ( asm ( "add r1, 100" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "add r1, -100" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "add r1, 131071" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "add r1, 131072" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "add r1, -131072" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "add r1, -131073" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "add r1, r2" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "add r1, r2, r3" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "add r1, 100(r3)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "add r1, -100(r3)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "add r1, 2047(r3)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "add r1, 2048(r3)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "add r1, -2048(r3)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "add r1, -2049(r3)" ))
# ---------------------------------------------------------------------------------------------
#
#
# =============================================================================================
# 
# Computational instruction options
#
# ADD, ADC, SUB, SBC, AND, OR, XOR, CMP, CMPU
# =============================================================================================
w disasm ( asm ( "add r1,r2" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "add.L r1,r2" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "add.O r1,r2" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "add.LO r1,r2" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "add.XX r1,r2" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "adc r1,r2" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "adc.L r1,r2" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "adc.O r1,r2" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "adc.LO r1,r2" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "adc.XX r1,r2" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "sub r1,r2" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "sub.L r1,r2" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "sub.O r1,r2" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "sub.LO r1,r2" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "sub.XX r1,r2" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "sbc r1,r2" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "sbc.L r1,r2" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "sbc.O r1,r2" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "sbc.LO r1,r2" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "sbc.XX r1,r2" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "and r1,r2" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "and.C r1,r2" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "and.N r1,r2" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "and.CN r1,r2" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "and.XX r1,r2" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "or r1,r2" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "or.C r1,r2" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "or.N r1,r2" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "or.CN r1,r2" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "or.XX r1,r2" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "xor r1,r2" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "xor.N r1,r2" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "xor.X r1,r2" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "cmp.EQ r1,r2" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "cmp.NE r1,r2" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "cmp.LT r1,r2" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "cmp.LE r1,r2" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "cmp.XX r1,r2" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "cmpu.EQ r1,r2" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "cmpu.NE r1,r2" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "cmpu.LT r1,r2" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "cmpu.LE r1,r2" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "cmpu.XX r1,r2" ))
# ---------------------------------------------------------------------------------------------
#
#
# =============================================================================================
# 
# Other Computational instruction
#
# LSID, EXTR, DEP, DSR, SHLA, CMR
# =============================================================================================
w disasm ( asm ( "lsid r1,r2" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "extr r1,r2, 5, 11" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "extr r1,r2, 32, 11" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "extr r1,r2, 5, 32" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "extr.S r1,r2, 5, 11" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "extr.A r1,r2, 5" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "extr.XX r1,r2, 5" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "dep r1,r2, 5, 11" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "dep r1,r2, 32, 11" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "dep r1, r2, 5, 32"
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "dep.Z r1,r2, 5, 11" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "dep.A r1,r2, 5" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "dep.I r1,r2, 5, 10" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "ds r1,r2,r3" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "ds r1,r2" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "ds r1" ))
# --------------------------------------------------------------------------------------------
w disasm ( asm ( "dsr r1, r3, r5, 10" ))
# --------------------------------------------------------------------------------------------
w disasm ( asm ( "dsr.a r1, r3, r5" ))
# --------------------------------------------------------------------------------------------
w disasm ( asm ( "dsr.a r1, r3, r5, 10" ))
# --------------------------------------------------------------------------------------------
w disasm ( asm ( "shla r1, r3, r5, 2" ))
# --------------------------------------------------------------------------------------------
w disasm ( asm ( "shla.L r1, r3, r5, 2" ))
# --------------------------------------------------------------------------------------------
w disasm ( asm ( "shla.I r1, r3, 10, 2" ))
# --------------------------------------------------------------------------------------------
w disasm ( asm ( "shla.I r1, r3, 11, 4" ))
# --------------------------------------------------------------------------------------------
w disasm ( asm ( "shla.IL r1, r3, 11, 2" ))
# --------------------------------------------------------------------------------------------
w disasm ( asm ( "shla.ILO r1, r3, 11, 2" ))
# --------------------------------------------------------------------------------------------
w disasm ( asm ( "CMR.EQ r1, r3, r2" ))
# --------------------------------------------------------------------------------------------
w disasm ( asm ( "CMR.NE r1, r3, r2" ))
# --------------------------------------------------------------------------------------------
w disasm ( asm ( "CMR.OD r1, r3, r2" ))
# --------------------------------------------------------------------------------------------
w disasm ( asm ( "CMR.EV r1, r3, r2" ))
# --------------------------------------------------------------------------------------------
w disasm ( asm ( "CMR.XX r1, r3, r2" ))
# --------------------------------------------------------------------------------------------
w disasm ( asm ( "LDIL r1, 100" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "LDIL r1, 0x3FFFFF" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "LDIL r1, 0x3FFFFF + 1" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "ADDIL r1, 100" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "ADDIL r1, 0x3fffff" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "ADDIL r1, 0x3fffff + 1" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "LDO r1, 100(r4)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "LDO r1, 0x1ffff + 1 (r4)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "LDO r1, -100(r4)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "LDO r1, - 0x20000 - 1 (r4)" ))
# ---------------------------------------------------------------------------------------------
#
#
# =============================================================================================
# 
# Load instructions
#
# LDx, LDA, LDR
# =============================================================================================
w disasm ( asm ( "LD r1, 100(r4)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "LD r1, -100(r4)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "LD r1, 2047(r4)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "LD r1, -2048(r4)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "LD r1, 2048(r4)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "LD r1, -2049(r4)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "LD r1, r2(r4)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "LD r1, (r4)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "LD.M r1, (r4)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "LDH.M r1, (r4)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "LDB r1, (r4)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "LDW r1, -1000(r4)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "LDW r1, -1000(s1, r4)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "LDR r1, -1000(r4)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "LDR r1, r5(r4)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "LDR r1, r5(s1, r4)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "LDA r1, 100(r4)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "LDA r1, -100(r4)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "LDA r1, 2047(r4)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "LDA r1, -2048(r4)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "LDA r1, 2048(r4)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "LDA r1, -2049(r4)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "LDA r1, r2(r4)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "LDA r1, (r4)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "LDA.M r1, (r4)" ))
# ---------------------------------------------------------------------------------------------
#
#
# =============================================================================================
# 
# Store instructions
#
# STx, STA, STC
# =============================================================================================
w disasm ( asm ( "ST r3, 100(r4)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "ST r3, -100(r4)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "ST r11, 2047(r4)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "ST r9, -2048(r4)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "ST r10, 2048(r4)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "ST r7, -2049(r4)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "ST r11, r2(r4)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "ST r15, (r4)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "ST r15, (s3, r4)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "ST.M r5, (r4)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "STB r5, 0(r4)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "STH r3, (r4)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "STW r12, -1000(r4)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "STC r13, -1000(r4)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "STC r8, r5(r4)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "STA r7, 100(r4)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "STA r6, -100(r4)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "STA r8, 2047(r4)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "STA r5, -2048(r4)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "STA r6, 2048(r4)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "STA r11, -2049(r4)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "STA r0, r2(r4)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "STA r5, (r4)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "STA.M r6, (r4)" ))
# ---------------------------------------------------------------------------------------------
#
#
# =============================================================================================
# 
# Branch instructions
#
# B, GATE, BR, BV, BE, BVE, CBR, CBRU
# =============================================================================================
w disasm ( asm ( "B 100, r2" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "B 100" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "B -100, r2" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "B 2097152 - 1, r2" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "B - 2097152 + 1, r2" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "B 2097152 + 1, r2" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "B - 2097152 - 1, r2" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "GATE 100, r2" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "GATE 100" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "BR (r1), r2" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "BR (r1)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "BV (r1), r2" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "BV (r1)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "BE (s1, r1)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "BE 100(s1, r1)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "BE -100 (s1, r1)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "BVE r3 (r1)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "BVE r3 (r1), r2" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "CBR.EQ  r1, r2, 100" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "CBR.NE  r1, r2, 100" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "CBR.LE  r1, r2, 100" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "CBR.LT  r1, r2, 100" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "CBR.EQ  r1, r2, - 100" ))
# ---------------------------------------------------------------------------------------------
#
#
# =============================================================================================
# 
# System Control Instructions
#
# MR, MST, LDPA, PRB, ITLB, PTLB, PCA, DIAG, RFI, BRK
# =============================================================================================
w disasm ( asm ( "mr r1, r2" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "mr r1, s2" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "mr s1, r2" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "mr r1, c2" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "mr c1, r2" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "mr c1, c2" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "mr s1, s2" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "mst r1, r2" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "mst.S r1, 0x1F" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "mst.C r1, 0x1F" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "mst.C r1, 0xFF" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "ldpa r1, r4 (s1, r5)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "ldpa r1, (s1, r5)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "ldpa r1, r3(r5)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "ldpa r1, (r5)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "diag r1, r5, r6, 15" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "diag r1, r5, r6, 16" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "diag r1, r5,  16" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "RFI" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "RFI 10" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "BRK 5, 10" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "BRK 20, 10" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "BRK 10, 65536" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "PRB r1, (s2, r9), r5" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "PRB.W r1, (s2, r9), r5" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "ITLB r1, (s2, r9)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "ITLB.T r1, (s2, r9)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "ITLB.T r1, (r3)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "PTLB r1(r3)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "PTLB r1(s3, r3)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "PTLB.T r1(s3, r3)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "PTLB.M r1(s3, r3)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "PTLB.TM r1(s3, r3)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "PTLB.XX™ r1(s3, r3)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "PCA r1(r3)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "PCA r1(s3, r3)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "PCA.T r1(s3, r3)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "PCA.FM r1(s3, r3)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "PCA.TM r1(s3, r3)" ))
# ---------------------------------------------------------------------------------------------
w disasm ( asm ( "PCA.XX r1(s3, r3)" ))
# ---------------------------------------------------------------------------------------------